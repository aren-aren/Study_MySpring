<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <!-- Mapper의 namespace는 비우면 error -->
<mapper namespace="com.moveone.app.departments.DepartmentDAO">

	<select id="getDetail" parameterType="DepartmentDTO" resultType="DepartmentDTO">
		SELECT * FROM DEPARTMENTS WHERE DEPARTMENT_ID = #{department_id}
	</select>
	
	<select id="getList" resultType="DepartmentDTO">
		SELECT * 
		FROM (
			SELECT ROWNUM R, DP.*
			FROM ( 
				SELECT * FROM DEPARTMENTS ORDER BY DEPARTMENT_ID DESC 
				) DP
			)
		WHERE R BETWEEN #{startRow} AND #{lastRow}
	</select>
	
	<select id="getTotal" resultType="java.lang.Long">
		SELECT COUNT(*) FROM DEPARTMENTS
	</select>
	
	<insert id="add" parameterType="DepartmentDTO">
		INSERT INTO DEPARTMENTS VALUES (DEPARTMENTS_SEQ.NEXTVAL, #{department_name}, #{manager_id}, #{location_id})
	</insert>
	
	<update id="update" parameterType="DepartmentDTO">
		UPDATE DEPARTMENTS 
		SET DEPARTMENT_NAME=#{department_name}, 
			MANAGER_ID=#{manager_id}, 
			LOCATION_ID=#{location_id}
		WHERE DEPARTMENT_ID=#{department_id}
	</update>
	
	<delete id="delete" parameterType="DepartmentDTO">
		DELETE DEPARTMENTS WHERE DEPARTMENT_ID=#{department_id}
	</delete>
</mapper>